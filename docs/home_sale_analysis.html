<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Fred J. Pasquarella">

<title>Home Sale Profit Model</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="home_sale_analysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="home_sale_analysis_files/libs/quarto-html/quarto.js"></script>
<script src="home_sale_analysis_files/libs/quarto-html/popper.min.js"></script>
<script src="home_sale_analysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="home_sale_analysis_files/libs/quarto-html/anchor.min.js"></script>
<link href="home_sale_analysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="home_sale_analysis_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="home_sale_analysis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="home_sale_analysis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="home_sale_analysis_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#the-property" id="toc-the-property" class="nav-link" data-scroll-target="#the-property"><span class="header-section-number">2</span> The Property</a></li>
  <li><a href="#comparable-homes" id="toc-comparable-homes" class="nav-link" data-scroll-target="#comparable-homes"><span class="header-section-number">3</span> Comparable Homes</a>
  <ul class="collapse">
  <li><a href="#as-is-to-minimal-repairs" id="toc-as-is-to-minimal-repairs" class="nav-link" data-scroll-target="#as-is-to-minimal-repairs"><span class="header-section-number">3.1</span> As Is to Minimal Repairs</a></li>
  <li><a href="#moderate-renovations" id="toc-moderate-renovations" class="nav-link" data-scroll-target="#moderate-renovations"><span class="header-section-number">3.2</span> Moderate Renovations</a></li>
  <li><a href="#full-remodel" id="toc-full-remodel" class="nav-link" data-scroll-target="#full-remodel"><span class="header-section-number">3.3</span> Full Remodel</a></li>
  </ul></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation"><span class="header-section-number">4</span> Data Preparation</a>
  <ul class="collapse">
  <li><a href="#renovation-levels-estimates" id="toc-renovation-levels-estimates" class="nav-link" data-scroll-target="#renovation-levels-estimates"><span class="header-section-number">4.1</span> Renovation Levels Estimates</a></li>
  <li><a href="#market-costs-and-net-proceeds-analysis" id="toc-market-costs-and-net-proceeds-analysis" class="nav-link" data-scroll-target="#market-costs-and-net-proceeds-analysis"><span class="header-section-number">4.2</span> Market Costs and Net Proceeds Analysis</a></li>
  <li><a href="#sales-price-ranges-and-probability-assignments" id="toc-sales-price-ranges-and-probability-assignments" class="nav-link" data-scroll-target="#sales-price-ranges-and-probability-assignments"><span class="header-section-number">4.3</span> Sales Price Ranges and Probability Assignments</a></li>
  </ul></li>
  <li><a href="#estimating-sale-price-and-net-proceeds" id="toc-estimating-sale-price-and-net-proceeds" class="nav-link" data-scroll-target="#estimating-sale-price-and-net-proceeds"><span class="header-section-number">5</span> Estimating Sale Price and Net Proceeds</a>
  <ul class="collapse">
  <li><a href="#estimating-sale-price-and-net-proceeds-1" id="toc-estimating-sale-price-and-net-proceeds-1" class="nav-link" data-scroll-target="#estimating-sale-price-and-net-proceeds-1"><span class="header-section-number">5.1</span> Estimating Sale Price and Net Proceeds</a></li>
  <li><a href="#why-monte-carlo" id="toc-why-monte-carlo" class="nav-link" data-scroll-target="#why-monte-carlo"><span class="header-section-number">5.2</span> Why Monte Carlo?</a></li>
  <li><a href="#return-on-investment" id="toc-return-on-investment" class="nav-link" data-scroll-target="#return-on-investment"><span class="header-section-number">5.3</span> Return on Investment</a></li>
  </ul></li>
  <li><a href="#probability-of-beating-the-investor-offer" id="toc-probability-of-beating-the-investor-offer" class="nav-link" data-scroll-target="#probability-of-beating-the-investor-offer"><span class="header-section-number">6</span> Probability of Beating the Investor Offer</a></li>
  <li><a href="#results-by-renovation-level" id="toc-results-by-renovation-level" class="nav-link" data-scroll-target="#results-by-renovation-level"><span class="header-section-number">7</span> Results by Renovation Level</a>
  <ul class="collapse">
  <li><a href="#summary-statistics-by-renovation-level" id="toc-summary-statistics-by-renovation-level" class="nav-link" data-scroll-target="#summary-statistics-by-renovation-level"><span class="header-section-number">7.1</span> Summary Statistics by Renovation Level</a></li>
  <li><a href="#net-proceeds-by-renovation-level" id="toc-net-proceeds-by-renovation-level" class="nav-link" data-scroll-target="#net-proceeds-by-renovation-level"><span class="header-section-number">7.2</span> Net Proceeds by Renovation Level</a></li>
  <li><a href="#probability-of-beating-the-investor-offer-by-repair-level" id="toc-probability-of-beating-the-investor-offer-by-repair-level" class="nav-link" data-scroll-target="#probability-of-beating-the-investor-offer-by-repair-level"><span class="header-section-number">7.3</span> Probability of Beating the Investor Offer by Repair Level</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">8</span> Conclusion</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Home Sale Profit Model</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Fred J. Pasquarella </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<blockquote class="blockquote">
<p>“The first step to reducing uncertainty is to measure it.” — Douglas W. Hubbard</p>
</blockquote>
<section id="introduction" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>This report presents a data-driven analysis to support an informed decision about selling a home. The key consideration was an investor’s offer to purchase the property “as is” at a fixed price, with only a 2% commission affecting the net proceeds. However, the seller was uncertain how this offer compared to potential market sales, where pricing and costs could vary significantly.</p>
<p>To address this, the report models potential market sale prices based on comparable homes and incorporates probabilistic scenarios for necessary renovations. A simulation was then conducted to estimate the expected net proceeds from listing the home on the market. Finally, the probability distribution of these net proceeds was compared against the investor’s offer, providing insight into the likelihood of achieving a better financial outcome through a traditional sale.</p>
</section>
<section id="the-property" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="the-property"><span class="header-section-number">2</span> The Property</h2>
<p>The property under consideration is located at <strong>340 Woodland Drive, San Pedro, CA 90732</strong>. It is a <strong>single-family home</strong> built in the <strong>1940s</strong>, featuring <strong>three bedrooms and two bathrooms</strong>. The home sits on a <strong>5,600 sq. ft. lot</strong>, with a total living space of <strong>1,500 sq. ft.</strong></p>
<p>While the property retains its original structure, it requires significant repairs and modernization. Notable concerns include <strong>outdated electrical and plumbing systems, foundation issues, and a necessary remodel of the bathrooms</strong>. These factors contribute to uncertainty regarding market pricing and potential costs associated with selling the home through a traditional listing.</p>
</section>
<section id="comparable-homes" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="comparable-homes"><span class="header-section-number">3</span> Comparable Homes</h2>
<p>Nine comparable homes were identified in the surrounding area. These properties have been categorized based on the level of renovation required to bring the subject property to a similar market condition.</p>
<p>While sale prices varied, the <em>comparables</em> ranged from <strong>$799,000 on the lower end to $988,000 at the higher end</strong>. The following tables provide a breakdown of these properties by renovation level, offering a clearer picture of potential market value under different renovation scenarios.</p>
<section id="as-is-to-minimal-repairs" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="as-is-to-minimal-repairs"><span class="header-section-number">3.1</span> As Is to Minimal Repairs</h3>
<table class="table">
<thead>
<tr class="header">
<th>Address</th>
<th style="text-align: center;">Bed</th>
<th style="text-align: center;">Bath</th>
<th style="text-align: center;">Sq Feet</th>
<th style="text-align: center;">Sale Price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://portal.onehome.com/en-US/property/aotf~1079432353~CRMLSM?token=eyJPU04iOiJDUk1MU00iLCJ0eXBlIjoiMCIsInNldGlkIjoiODg5NzE4NTAyIiwic2V0a2V5IjoiODA0IiwiZW1haWwiOiJmcmVkcGFzcXVhcmVsbGFAZ21haWwuY29tIiwicmVzb3VyY2VpZCI6MCwiYWdlbnRpZCI6MjE3NzU1MSwibGlzdGluZ2lkIjoiNDIwOTE0ODQ0IiwiVmlld01vZGUiOiIxIn0%3D&amp;searchId=c6f729e6-8039-34da-9f98-afa5c0aadcdc">975 W 3rd Street San Pedro, CA 90731</a></td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1,306</td>
<td style="text-align: center;">$799,000</td>
</tr>
<tr class="even">
<td><a href="https://portal.onehome.com/en-US/listing?token=eyJPU04iOiJDUk1MU00iLCJ0eXBlIjoiMCIsInNldGlkIjoiODg5NzE4NTAyIiwic2V0a2V5IjoiODA0IiwiZW1haWwiOiJmcmVkcGFzcXVhcmVsbGFAZ21haWwuY29tIiwicmVzb3VyY2VpZCI6MCwiYWdlbnRpZCI6MjE3NzU1MSwibGlzdGluZ2lkIjoiNDMxODk1Njk2IiwiVmlld01vZGUiOiIxIn0%3D&amp;SMS=0">1123 W 2nd Street, San Pedro, CA 90731</a></td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1,611</td>
<td style="text-align: center;">$812,000</td>
</tr>
<tr class="odd">
<td><a href="https://portal.onehome.com/en-US/property/aotf~1103290654~CRMLSM?token=eyJPU04iOiJDUk1MU00iLCJ0eXBlIjoiMCIsInNldGlkIjoiODg5NzE4NTAyIiwic2V0a2V5IjoiODA0IiwiZW1haWwiOiJmcmVkcGFzcXVhcmVsbGFAZ21haWwuY29tIiwicmVzb3VyY2VpZCI6MCwiYWdlbnRpZCI6MjE3NzU1MSwibGlzdGluZ2lkIjoiNDMwOTA1MDkwIiwiVmlld01vZGUiOiIxIn0%3D&amp;searchId=c6f729e6-8039-34da-9f98-afa5c0aadcdc">1284 W 9th Street, San Pedro, CA 90731</a></td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1,208</td>
<td style="text-align: center;">$829,000</td>
</tr>
<tr class="even">
<td><a href="https://portal.onehome.com/en-US/property/aotf~1081855731~CRMLSM?token=eyJPU04iOiJDUk1MU00iLCJ0eXBlIjoiMCIsInNldGlkIjoiODg5NzE4NTAyIiwic2V0a2V5IjoiODA0IiwiZW1haWwiOiJmcmVkcGFzcXVhcmVsbGFAZ21haWwuY29tIiwicmVzb3VyY2VpZCI6MCwiYWdlbnRpZCI6MjE3NzU1MSwibGlzdGluZ2lkIjoiNDIxNzA2MTQ0IiwiVmlld01vZGUiOiIxIn0%3D&amp;searchId=c6f729e6-8039-34da-9f98-afa5c0aadcdc">619 S Cabrillo Avenue, San Pedro, CA 90731</a></td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1,620</td>
<td style="text-align: center;">$840,000</td>
</tr>
</tbody>
</table>
</section>
<section id="moderate-renovations" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="moderate-renovations"><span class="header-section-number">3.2</span> Moderate Renovations</h3>
<table class="table">
<thead>
<tr class="header">
<th>Address</th>
<th style="text-align: center;">Bed</th>
<th style="text-align: center;">Bath</th>
<th style="text-align: center;">Sq Feet</th>
<th style="text-align: center;">Sale Price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://portal.onehome.com/en-US/property/aotf~1081855731~CRMLSM?token=eyJPU04iOiJDUk1MU00iLCJ0eXBlIjoiMCIsInNldGlkIjoiODg5NzE4NTAyIiwic2V0a2V5IjoiODA0IiwiZW1haWwiOiJmcmVkcGFzcXVhcmVsbGFAZ21haWwuY29tIiwicmVzb3VyY2VpZCI6MCwiYWdlbnRpZCI6MjE3NzU1MSwibGlzdGluZ2lkIjoiNDIxNzA2MTQ0IiwiVmlld01vZGUiOiIxIn0%3D&amp;searchId=c6f729e6-8039-34da-9f98-afa5c0aadcdc">919 W Third street San Pedro, CA 90731</a></td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1,244</td>
<td style="text-align: center;">$839,000</td>
</tr>
<tr class="even">
<td><a href="https://portal.onehome.com/en-US/property/aotf~1108301693~CRMLSM?token=eyJPU04iOiJDUk1MU00iLCJ0eXBlIjoiMCIsInNldGlkIjoiODg5NzE4NTAyIiwic2V0a2V5IjoiODA0IiwiZW1haWwiOiJmcmVkcGFzcXVhcmVsbGFAZ21haWwuY29tIiwicmVzb3VyY2VpZCI6MCwiYWdlbnRpZCI6MjE3NzU1MSwibGlzdGluZ2lkIjoiNDMzNTA3OTAyIiwiVmlld01vZGUiOiIxIn0%3D&amp;searchId=c6f729e6-8039-34da-9f98-afa5c0aadcdc">1368 W Summerland Avenue, San Pedro, CA 90732</a></td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1,412</td>
<td style="text-align: center;">$899,000</td>
</tr>
</tbody>
</table>
</section>
<section id="full-remodel" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="full-remodel"><span class="header-section-number">3.3</span> Full Remodel</h3>
<table class="table">
<thead>
<tr class="header">
<th>Address</th>
<th style="text-align: center;">Bed</th>
<th style="text-align: center;">Bath</th>
<th style="text-align: center;">Sq Feet</th>
<th style="text-align: center;">Sale Price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://portal.onehome.com/en-US/property/aotf~1107286323~CRMLSM?token=eyJPU04iOiJDUk1MU00iLCJ0eXBlIjoiMCIsInNldGlkIjoiODg5NzE4NTAyIiwic2V0a2V5IjoiODA0IiwiZW1haWwiOiJmcmVkcGFzcXVhcmVsbGFAZ21haWwuY29tIiwicmVzb3VyY2VpZCI6MCwiYWdlbnRpZCI6MjE3NzU1MSwibGlzdGluZ2lkIjoiNDMyMjEyOTc2IiwiVmlld01vZGUiOiIxIn0%3D&amp;searchId=c6f729e6-8039-34da-9f98-afa5c0aadcdc">1173 W 2nd Street, San Pedro, CA 90731-2306</a></td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1,478</td>
<td style="text-align: center;">$922,000</td>
</tr>
<tr class="even">
<td><a href="https://portal.onehome.com/en-US/property/aotf~1089655791~CRMLSM?token=eyJPU04iOiJDUk1MU00iLCJ0eXBlIjoiMCIsInNldGlkIjoiODg5NzE4NTAyIiwic2V0a2V5IjoiODA0IiwiZW1haWwiOiJmcmVkcGFzcXVhcmVsbGFAZ21haWwuY29tIiwicmVzb3VyY2VpZCI6MCwiYWdlbnRpZCI6MjE3NzU1MSwibGlzdGluZ2lkIjoiNDI0NTA4MzQwIiwiVmlld01vZGUiOiIxIn0%3D&amp;searchId=c6f729e6-8039-34da-9f98-afa5c0aadcdc">1446 W Sepulveda Street San Pedro, CA 90732</a></td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">2,124</td>
<td style="text-align: center;">$970,000</td>
</tr>
<tr class="odd">
<td><a href="https://portal.onehome.com/en-US/property/aotf~1078456504~CRMLSM?token=eyJPU04iOiJDUk1MU00iLCJ0eXBlIjoiMCIsInNldGlkIjoiODg5NzE4NTAyIiwic2V0a2V5IjoiODA0IiwiZW1haWwiOiJmcmVkcGFzcXVhcmVsbGFAZ21haWwuY29tIiwicmVzb3VyY2VpZCI6MCwiYWdlbnRpZCI6MjE3NzU1MSwibGlzdGluZ2lkIjoiNDE5NDU4NjMwIiwiVmlld01vZGUiOiIxIn0%3D&amp;searchId=c6f729e6-8039-34da-9f98-afa5c0aadcdc">633 S Meyler Street San Pedro, CA 90731</a></td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">1,913</td>
<td style="text-align: center;">$998,888</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="data-preparation" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="data-preparation"><span class="header-section-number">4</span> Data Preparation</h2>
<p>We created a number of data tables to model market sales. First, renovation level estimates were created. Then, market costs and net proceeds were listed. Lastly, sales prices and probabilities for sales at different renovation levels were made. Please note that sale probabilities and renovation costs were informed estimations and should be reviewed and refined if new information is discovered.</p>
<section id="renovation-levels-estimates" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="renovation-levels-estimates"><span class="header-section-number">4.1</span> Renovation Levels Estimates</h3>
<p>The estimated renovation costs were derived from owner knowledge, a 2021 inspection report, and an investor-provided repair cost sheet. A full remodel of the home would require work across multiple areas, including:</p>
<ul>
<li>Foundation Repairs &amp; Structural Reinforcement</li>
<li>Plumbing Repairs (Leaks, Corrosion, TPRV Drain Tube)</li>
<li>Electrical Upgrades (Zinsco Panel Replacement)</li>
<li>Bathroom Remodel (Mold Remediation, Flooring, Fixtures)</li>
<li>Second Bathroom Remodel</li>
<li>Kitchen Updates (Cabinets, Counters, Appliances)</li>
<li>Flooring Replacement (Throughout House)</li>
<li>Flooring Repair (Carpet Removal, Sanding, Refinishing)</li>
<li>Interior &amp; Exterior Painting</li>
<li>Roof Repairs &amp; Fascia Replacement</li>
<li>Landscaping &amp; Curb Appeal Improvements</li>
<li>Miscellaneous Repairs &amp; Contingency</li>
<li>Property Clear-Out</li>
</ul>
<p>The investor estimated that a full remodel would cost $139,000, with foundation repairs being the most expensive item at $27,000. While the accuracy of the investor’s cost estimates is uncertain—given their ability to complete work at lower rates—it still serves as a reasonable baseline for assessing repair costs.</p>
<p>To evaluate potential market sale outcomes, four distinct renovation scenarios were developed:</p>
<ol type="1">
<li>Bare Minimum: Covers only essential work to make the home presentable, including property clear-out, landscaping for curb appeal, painting, and minimal floor work.</li>
<li>Minimal Repairs: Includes all bare minimum improvements, along with updates to the master bathroom and some electrical work.</li>
<li>Moderate Renovations: Builds on the minimal repairs by also addressing the second bathroom and kitchen updates.</li>
<li>Full Remodel: Encompasses all necessary work to bring the home to full market condition, covering every aspect listed above.</li>
</ol>
<p>The following section provides cost estimates for each of these scenarios to better understand potential net proceeds under different renovation levels.</p>
<table class="table">
<thead>
<tr class="header">
<th>Renovation Level</th>
<th style="text-align: center;">Cost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Bare Minimum (bare)</td>
<td style="text-align: center;">$15,000</td>
</tr>
<tr class="even">
<td>Minimal Repairs (min)</td>
<td style="text-align: center;">$34,000</td>
</tr>
<tr class="odd">
<td>Moderate Renovations (mod)</td>
<td style="text-align: center;">$78,000</td>
</tr>
<tr class="even">
<td>Full Remodel (full)</td>
<td style="text-align: center;">$174,000</td>
</tr>
</tbody>
</table>
</section>
<section id="market-costs-and-net-proceeds-analysis" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="market-costs-and-net-proceeds-analysis"><span class="header-section-number">4.2</span> Market Costs and Net Proceeds Analysis</h3>
<p>The primary objective of this analysis is to estimate net proceeds from a market sale and compare them to the net proceeds from an investor offer. Below are the key variables and the formulas used to calculate net proceeds for each scenario.</p>
<section id="market-sale-net-proceeds-calculation" class="level4" data-number="4.2.1">
<h4 data-number="4.2.1" class="anchored" data-anchor-id="market-sale-net-proceeds-calculation"><span class="header-section-number">4.2.1</span> Market Sale Net Proceeds Calculation</h4>
<p>The net proceeds from a market sale are determined by the <strong>sales price (SP)</strong>, minus associated costs, including escrow fees, agent commissions, outstanding mortgage balance, and expected repair costs. The breakdown is as follows:</p>
<ul>
<li>SP = Sale Price</li>
<li>Variable Rate from Escrow (Escrow) = SP * 1.1%</li>
<li>Fixed Fees from Sale (Fees) = $2,412</li>
<li>Commission (Commission) = SP * 5%</li>
<li>Current Mortgage (Loan) = $314,000</li>
<li>Expected Repair Costs (ExpRepair): weighted average repair cost based on different renovation scenarios</li>
</ul>
<p><span class="math display">\[
ExpRepair = (Bare * ProbBare) + (Min * ProbMin) + (Mod * ProbMod) + (Full * ProbFull)
\]</span></p>
<p>The final formula for <strong>net proceeds from a market sale</strong> is:</p>
<p><span class="math display">\[
NETmarket = SP - (SP * 0.011 - 0.05) - 2,412 - 314,000 - ExpRepair
\]</span></p>
</section>
<section id="investor-offer-net-proceeds-calculation" class="level4" data-number="4.2.2">
<h4 data-number="4.2.2" class="anchored" data-anchor-id="investor-offer-net-proceeds-calculation"><span class="header-section-number">4.2.2</span> Investor Offer Net Proceeds Calculation</h4>
<p>The investor offer eliminates repair costs since the home is sold <strong>“as-is”</strong>. Additionally, the investor <strong>covers all other costs</strong> except for a <strong>2% commission</strong> on the sale price (OP). The net proceeds formula for the investor offer is:</p>
<p><span class="math display">\[
NEToffer = OP - (OP * 0.02) - 314,000
\]</span></p>
</section>
</section>
<section id="sales-price-ranges-and-probability-assignments" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="sales-price-ranges-and-probability-assignments"><span class="header-section-number">4.3</span> Sales Price Ranges and Probability Assignments</h3>
<p>Market sales prices were set within a range of $750,000 to $1,050,000, increasing in $5,000 increments. This range was determined based on comparable home sales, the investor’s offer, and the expected post-renovation flip price of the property.</p>
<p>To more accurately reflect market dynamics, a two-stage probability model was used:</p>
<ol type="1">
<li><p>Probability of selecting a renovation level – Each repair level had a probability representing the likelihood of a seller choosing that level of renovation.</p></li>
<li><p>Conditional probability of sales price – Given a renovation level, a probability distribution was assigned to potential sales prices, reflecting the likelihood of achieving a specific price based on the level of repairs completed.</p></li>
</ol>
<p>This approach incorporates both market uncertainty and the impact of renovations on price outcomes, providing a data-driven comparison of financial outcomes between a market sale and accepting the investor’s offer. The following section presents a sample of the probability distribution used in the analysis.</p>
<p>Below is the table for the probability of selecting a renovation level.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Probability of selecting a renovation level</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Renovation Level</th>
<th style="text-align: right;">Probability</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Bare Minimum</td>
<td style="text-align: right;">0.25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Minimal</td>
<td style="text-align: right;">0.35</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Moderate</td>
<td style="text-align: right;">0.30</td>
</tr>
<tr class="even">
<td style="text-align: left;">Full</td>
<td style="text-align: right;">0.10</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Here is a sample of the conditional probabilities of sales price at a given renovation level.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Conditional probability of sales price</caption>
<colgroup>
<col style="width: 15%">
<col style="width: 17%">
<col style="width: 16%">
<col style="width: 17%">
<col style="width: 12%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Sales Price</th>
<th style="text-align: right;">Bare Min Prob</th>
<th style="text-align: right;">Minimal Prob</th>
<th style="text-align: right;">Moderate Prob</th>
<th style="text-align: right;">Full Prob</th>
<th style="text-align: right;">Exp Repair Cost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">750000</td>
<td style="text-align: right;">0.85</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">18450</td>
</tr>
<tr class="even">
<td style="text-align: right;">800000</td>
<td style="text-align: right;">0.60</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">28450</td>
</tr>
<tr class="odd">
<td style="text-align: right;">850000</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.70</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">54750</td>
</tr>
<tr class="even">
<td style="text-align: right;">900000</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.34</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">113100</td>
</tr>
<tr class="odd">
<td style="text-align: right;">950000</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">0.70</td>
<td style="text-align: right;">145150</td>
</tr>
<tr class="even">
<td style="text-align: right;">1000000</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">170250</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="estimating-sale-price-and-net-proceeds" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="estimating-sale-price-and-net-proceeds"><span class="header-section-number">5</span> Estimating Sale Price and Net Proceeds</h2>
<section id="estimating-sale-price-and-net-proceeds-1" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="estimating-sale-price-and-net-proceeds-1"><span class="header-section-number">5.1</span> Estimating Sale Price and Net Proceeds</h3>
<section id="monte-carlo-simulation" class="level4" data-number="5.1.1">
<h4 data-number="5.1.1" class="anchored" data-anchor-id="monte-carlo-simulation"><span class="header-section-number">5.1.1</span> Monte Carlo Simulation</h4>
<p>To capture the inherent uncertainty in the home sale process, a Monte Carlo simulation was conducted using 10,000 iterations. This simulation provides a probabilistic estimate of the likely sales price and corresponding net proceeds under different renovation scenarios.</p>
<p>The simulation process involved the following steps:</p>
<ol type="1">
<li><p>Randomly Selecting a Repair Level: Each iteration first selected a renovation level based on its probability distribution, reflecting the likelihood of different repair strategies.</p></li>
<li><p>Randomly Selecting a Sales Price: A sales price was then drawn from the probability distribution corresponding to the chosen renovation level. This approach ensures that home values reflect real-world variations in pricing based on property condition.</p></li>
<li><p>Calculating Net Proceeds for Each Iteration: Using the selected sales price and renovation level, the market sale net proceeds formula was applied, accounting for: Escrow fees; Agent commissions; Remaining mortgage balance; Renovation costs. The same calculation was performed for the investor offer, where no renovation costs were incurred and a fixed 2% commission was deducted.</p></li>
<li><p>Building the Probability Distribution of Outcomes: After running 10,000 simulations, the results were aggregated into a probability distribution of net proceeds from a market sale. This distribution was then compared against the net proceeds from the investor offer, allowing us to quantify the likelihood of achieving a better financial outcome by selling on the market.</p></li>
</ol>
</section>
</section>
<section id="why-monte-carlo" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="why-monte-carlo"><span class="header-section-number">5.2</span> Why Monte Carlo?</h3>
<p>Monte Carlo simulation is particularly useful in real estate decision-making because it allows for a more comprehensive assessment of risk and uncertainty. Instead of relying on a single-point estimate, this method provides a range of possible outcomes, helping the seller understand:</p>
<ul>
<li>The probability of different sale price scenarios</li>
<li>The expected variation in net proceeds</li>
<li>The risk-reward trade-off between selling on the market and taking the investor offer</li>
</ul>
<p>By simulating thousands of possible sale outcomes, this approach provides a data-driven framework for making an informed decision.</p>
<p>The next section presents the results of the simulation, including expected net proceeds, probability distributions, and a comparison to the investor’s offer.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Simulation Results for Net Proceeds</caption>
<thead>
<tr class="header">
<th style="text-align: right;">Mean Net</th>
<th style="text-align: right;">Median Net</th>
<th style="text-align: right;">SD Net</th>
<th style="text-align: right;">Min Net</th>
<th style="text-align: right;">Max Net</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">433664</td>
<td style="text-align: right;">431908</td>
<td style="text-align: right;">44758</td>
<td style="text-align: right;">270178</td>
<td style="text-align: right;">561113</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output-display">
<p><img src="home_sale_analysis_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="home_sale_analysis_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="return-on-investment" class="level3" data-number="5.3">
<h3 data-number="5.3" class="anchored" data-anchor-id="return-on-investment"><span class="header-section-number">5.3</span> Return on Investment</h3>
<p>To assess the financial viability of selling the property on the open market, a Return on Investment (ROI) analysis was conducted. This analysis compares the net financial returns from a market sale to the costs incurred through necessary repairs and transaction fees. Additionally, it evaluates how the potential ROI from a market sale compares to the ROI from accepting the investor offer, providing a clear picture of the financial trade-offs between the two options.</p>
<p>By leveraging Monte Carlo simulation results, we computed two key ROI metrics:</p>
<ol type="1">
<li>ROI from Market Sale – This measures the return relative to the renovation costs:</li>
</ol>
<p><span class="math display">\[
ROI = (Net Proceeds - Repair Costs)/Repair Costs
\]</span></p>
<p>This reflects how much value is gained (or lost) for every <strong>dollar spent on repairs</strong>.</p>
<ol type="1">
<li>ROI Compared to the Investor Offer – This measures the additional return from a market sale relative to the investor’s net offer:</li>
</ol>
<p><span class="math display">\[
ROIinvestor = (Net Proceeds - Net Investor Offer)/Net Investor Offer
\]</span></p>
<p>A positive ROI indicates that selling on the market is expected to yield a higher return than accepting the investor’s offer.</p>
<p>By analyzing these ROI distributions, we gain insights into:</p>
<ul>
<li><p>The likelihood of a profitable return from selling on the market.</p></li>
<li><p>The probability that market sale outperforms the investor’s offer.</p></li>
<li><p>The potential risks and variability associated with each decision.</p></li>
</ul>
<p>The following sections present summary statistics and visualizations to illustrate the distribution of expected ROI under different market conditions.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Summary Statisc for ROI from Market Sale</caption>
<thead>
<tr class="header">
<th style="text-align: right;">Mean ROI</th>
<th style="text-align: right;">Median ROI</th>
<th style="text-align: right;">SD ROI</th>
<th style="text-align: right;">Min ROI</th>
<th style="text-align: right;">Max ROI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">11.84169</td>
<td style="text-align: right;">9.936</td>
<td style="text-align: right;">8.841543</td>
<td style="text-align: right;">0.5527471</td>
<td style="text-align: right;">33.24587</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output-display">
<p><img src="home_sale_analysis_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Summary Statisc for ROI Compared to Investor Offer</caption>
<thead>
<tr class="header">
<th style="text-align: right;">Mean ROI</th>
<th style="text-align: right;">Median ROI</th>
<th style="text-align: right;">SD ROI</th>
<th style="text-align: right;">Min ROI</th>
<th style="text-align: right;">Max ROI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.0300802</td>
<td style="text-align: right;">0.0259097</td>
<td style="text-align: right;">0.1063129</td>
<td style="text-align: right;">-0.358247</td>
<td style="text-align: right;">0.33281</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output-display">
<p><img src="home_sale_analysis_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="probability-of-beating-the-investor-offer" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="probability-of-beating-the-investor-offer"><span class="header-section-number">6</span> Probability of Beating the Investor Offer</h2>
<p>A key component of this analysis is determining the likelihood that selling on the market will result in higher net proceeds than the investor’s offer. By leveraging the Monte Carlo simulation results, we calculated the probability that a market sale would yield greater net proceeds than the investor’s offer after accounting for transaction costs and renovations.</p>
<p>This probability is computed as:</p>
<p><span class="math display">\[
P(Net Proceeds) &gt; NetInvestorOffer
\]</span></p>
<section id="interpreting-the-probability-value" class="level4" data-number="6.0.1">
<h4 data-number="6.0.1" class="anchored" data-anchor-id="interpreting-the-probability-value"><span class="header-section-number">6.0.1</span> Interpreting the Probability Value</h4>
<ul>
<li><p>Above 50% → The market sale is statistically more likely to result in a better financial outcome than the investor offer.</p></li>
<li><p>Below 50% → The investor offer is the more favorable option in most scenarios.</p></li>
<li><p>Close to 50% → The decision is highly uncertain, and additional factors (e.g., risk tolerance, time constraints) should be considered.</p></li>
</ul>
<p>By analyzing this probability alongside the distribution of net proceeds and ROI, we can quantify the risk-reward trade-off of going to market versus accepting a guaranteed investor sale. The following section presents the results of this comparison, including probability distributions and insights into the expected financial advantages or disadvantages of each option.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Probability of Netting More Than $ 421,000 :  57.82 %</code></pre>
</div>
<div class="cell-output-display">
<p><img src="home_sale_analysis_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>To contextualize this further, we tested scenarios where a traditational sale would beat the investor offer. We first looked at the probability of making less than $10,000 compared to the investor offer. Next, we looked at the probability of making more than $10,000 over the investor offer.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Probability of Less Than $ 411,000 :  34.41 %</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Probability of Netting More Than $ 431,000 :  50.71 %</code></pre>
</div>
</div>
</section>
</section>
<section id="results-by-renovation-level" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="results-by-renovation-level"><span class="header-section-number">7</span> Results by Renovation Level</h2>
<p>While the overall probability of beating the investor offer provides a broad financial outlook, breaking down the results by renovation level offers a more nuanced perspective on the potential return of different repair strategies. Instead of treating all market sales equally, this analysis examines how varying levels of renovation impact net proceeds, return on investment (ROI), and the likelihood of outperforming the investor offer.</p>
<p>By segmenting the results based on renovation level, we can answer key questions such as:</p>
<ul>
<li><p>Which level of renovation provides the highest expected return?</p></li>
<li><p>How does the risk of financial loss change with different repair strategies?</p></li>
<li><p>At what point does additional investment in repairs yield diminishing returns?</p></li>
</ul>
<p>To explore these factors, we compare net proceeds distributions, ROI calculations, and the probability of beating the investor offer across all four renovation levels. This provides a data-driven framework for determining the optimal selling strategy—whether that means making minimal repairs or investing in a full remodel.</p>
<section id="summary-statistics-by-renovation-level" class="level3" data-number="7.1">
<h3 data-number="7.1" class="anchored" data-anchor-id="summary-statistics-by-renovation-level"><span class="header-section-number">7.1</span> Summary Statistics by Renovation Level</h3>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Summary Statistics by Renovation Level</caption>
<colgroup>
<col style="width: 22%">
<col style="width: 9%">
<col style="width: 11%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Renovation Level</th>
<th style="text-align: right;">Mean Net</th>
<th style="text-align: right;">Median Net</th>
<th style="text-align: right;">SD Net</th>
<th style="text-align: right;">Min Net</th>
<th style="text-align: right;">Max Net</th>
<th style="text-align: right;">Mean ROI</th>
<th style="text-align: right;">Prob Beat Investor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Bare Minimum</td>
<td style="text-align: right;">406554</td>
<td style="text-align: right;">401008</td>
<td style="text-align: right;">25565</td>
<td style="text-align: right;">372838</td>
<td style="text-align: right;">513688</td>
<td style="text-align: right;">26.1</td>
<td style="text-align: right;">0.239</td>
</tr>
<tr class="even">
<td style="text-align: left;">Minimal Renovations</td>
<td style="text-align: right;">438443</td>
<td style="text-align: right;">439043</td>
<td style="text-align: right;">37848</td>
<td style="text-align: right;">349838</td>
<td style="text-align: right;">561113</td>
<td style="text-align: right;">10.5</td>
<td style="text-align: right;">0.667</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Moderate Renovations</td>
<td style="text-align: right;">453170</td>
<td style="text-align: right;">455383</td>
<td style="text-align: right;">50599</td>
<td style="text-align: right;">309838</td>
<td style="text-align: right;">558673</td>
<td style="text-align: right;">4.8</td>
<td style="text-align: right;">0.760</td>
</tr>
<tr class="even">
<td style="text-align: left;">Full Remodel</td>
<td style="text-align: right;">425118</td>
<td style="text-align: right;">434503</td>
<td style="text-align: right;">50737</td>
<td style="text-align: right;">270178</td>
<td style="text-align: right;">495538</td>
<td style="text-align: right;">1.4</td>
<td style="text-align: right;">0.568</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="net-proceeds-by-renovation-level" class="level3" data-number="7.2">
<h3 data-number="7.2" class="anchored" data-anchor-id="net-proceeds-by-renovation-level"><span class="header-section-number">7.2</span> Net Proceeds by Renovation Level</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="home_sale_analysis_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="probability-of-beating-the-investor-offer-by-repair-level" class="level3" data-number="7.3">
<h3 data-number="7.3" class="anchored" data-anchor-id="probability-of-beating-the-investor-offer-by-repair-level"><span class="header-section-number">7.3</span> Probability of Beating the Investor Offer by Repair Level</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="home_sale_analysis_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="conclusion" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">8</span> Conclusion</h2>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>